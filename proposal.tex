\documentclass[letterpaper, 11pt]{article}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{float}
\usepackage{inputenc}
\usepackage[left=2cm, right=2cm, top=2cm, bottom=2cm]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\usepackage{extarrows}
\usepackage{xcolor}
\usepackage{lscape}
\usepackage{pdflscape}
\usepackage{pdfpages}
\usepackage{multicol}
\usepackage{leftindex}
\usepackage{algorithm2e}
\SetKwComment{Comment}{/* }{ */}
%\RestyleAlgo{ruled}
\usepackage{mathtools}
\usepackage{hyperref}
\hypersetup{
    colorlinks=false,
    }

% Listings
\usepackage{listings}
\usepackage{color}
\input{lst_style.tex}

% NewCommands
\newcommand{\peq}{ \mathrel{+}= }
\newcommand{\muleq}{ \mathrel{*}= }
\newcommand{\sign}{ \text{sign}}
\newcommand{\bm}[1]{\begin{bmatrix} #1 \end{bmatrix}}
\newcommand{\mat}[1]{\begin{matrix} #1 \end{matrix}}
\newcommand{\lx}[2]{\leftindex #1 {#2}}
\newcommand{\norm}[1]{\left\lvert #1 \right\rvert}
\newcommand{\itbf}[1]{\textit{\textbf{#1}}}
\newcommand{\mdet}[1]{\norm{\begin{matrix} #1 \end{matrix}}}
\newcommand{\pbox}[1]{\fbox{\begin{minipage}{\textwidth} #1 \end{minipage}}}
\newcommand{\lstln}[1]{\lstinline|#1|}
\newcommand{\lr}[1]{\left( #1 \right)}
\newcommand{\lrb}[1]{\left[ #1 \right]}


\title{Statement of Work - Purdue University \\ For Cummins Advanced Engineering Controls}
\author{
\itbf{Principal Investigator}: Prof. Peter H. Meckl, Purdue University}
\date{\today}


\begin{document}
\maketitle
\tableofcontents
\newpage
\
\newpage
%===============================================================================

\section{Objective}
To develop model-based non-intrusive on-board diagnostics (OBD) tools to detect
catalyst-degradation in automotive Selective Catalytic Reduction (SCR) - Ammonia
Slip Catalyst (ASC) system.

\section{Background}
Modern Diesel after-treatment systems with Selective Catalytic Reduction (SCR)
- Ammonia Slip Catalyst (ASC) need on-board diagnostics (OBD) tools that can
accurately report SCR degradation level while avoiding false pass and false
fail. The diagnostic tool's performance must contain the following features: 1)
high estimation accuracy; 2) high robustness against various noise factors
under harsh on-road operating conditions; 3) minimal negative impact on SCR
emissions control; and 4) cost-effective by using existing SCR configurations
and commercially available $NO_x$ sensors. Purdue University and Tennessee
Technological University (TTU) have researched the literature on
control-oriented SCR-aging models and various estimation methods for developing
such a diagnostic tool. Since it is very difficult to imitate real-world
catalyst degradation using test-cell accelerated aging, none of the existing
control-oriented SCR-aging models have been validated or tested on real-world
catalyst degradation data. Another limitation of existing OBD methods for SCR
systems is that they do not consider the presence of Ammonia Slip Catalyst
(ASC) in series with SCR. Also, most existing OBD approaches cannot work under
the limitations of commercial after-treatment instrumentation such as no NH3
sensors, cross-sensitive $NO_x$ sensors etc. Therefore, development of better
models to design OBD methods that can work with commercial systems under
on-road conditions is required. Purdue University and TTU have already
initiated the research effort in collaboration with Cummins Inc. to fill this
gap by investigating model-based and data-driven diagnostic algorithms to
detect aging in SCR systems. The overall research endeavor includes:

\begin{enumerate}
\item achieving insight in SCR aging from modeling and diagnostic perspectives
via the comprehensive analysis of experimental data;
\item developing accurate control-oriented after-treatment models to predict
reduced emissions' performance at different degradation levels, and
\item developing robust and effective non-intrusive diagnostic methods that could distinguish SCR catalysts at different aging levels for real-world driving conditions.
\end{enumerate}

As part of this effort, Cummins provided real-world truck data and test-cell
data, along with seed funds for the year 2022, to Purdue University and TTU. In
the year 2022, Purdue and TTU thoroughly studied the data, and explored several
model-based and data-driven OBD approaches. For the model-based approach,
Purdue developed a model and a model-based OBD for the operating conditions
when ASC is active, and TTU has been working on a complementary model for
conditions when the ASC is inactive. For the data-driven approach, Purdue
worked on a binary classifier to classify the catalyst as either degreened (DG)
or EUL at each time-stamp, and TTU has been working on exploring several
methods to detect $NO_x$-rich operating conditions which are suitable to
extract distinct features from each truck. The motivation behind this proposal
is to obtain funds for the year 2024 to continue this effort to develop OBD
method capable of meeting the previously laid out requirements.

This is a joint effort by Purdue University and TTU and this document proposes
Purdue's share of the work for 2024. Purdue will focus on improving the
model-based and data-driven OBD approaches with the following goals for 2023:
\begin{enumerate}
\item validate and improve the diagnostics-oriented SCR-ASC model using
additional test-cell data and a high-fidelity SCR-ASC model from Cummins' (AVL
boost model)
\item validate and improve both model-based and data-driven OBD methods using
high-fidelity simulations and truck data with known aging levels (could be DG
and/or EUL), and
\item  support TTU in development and demonstration of model-based and data-driven OBD methods that rely on detecting $NO_x$-rich operating conditions where ASC is inactive
\end{enumerate}

Based on the findings from data analysis, models and diagnostic algorithms
developed in 2022 and 2023 by Purdue and TTU, the implementation and field
validation of model-based non-intrusive diagnostic methods that could work with
the Cummins existing commercial SCR systems will be planned in follow-on work.

\subsection{Research Expertise and Qualification}
The research team consists of Purdue University and TTU. The research expertise and qualification of Purdue University to successfully complete the project are described as follows:

The research group from Purdue University is led by Prof. Peter H. Meckl. Prof.
Meckl is a Professor of Mechanical Engineering at Purdue University. He received
his B.S. degree in Mechanical Engineering from Northwestern University in 1981,
M.S. in Mechanical Engineering from MIT in 1984, and Ph.D. in Mechanical
Engineering from MIT in 1988. He was the principal investigator for Purdue
EcoCAR2 project. He and his team have written 45 archival journal papers and
over 100 refereed conference papers, many of them concerning automotive control.
Much of the research on engine and after-treatment diagnostics and control has
been sponsored by Cummins, work that spans over 25 years. He has been involved
in research on modeling and control of urea-SCR systems starting in 2013 and has
graduated four M.S. thesis students who worked on modeling, estimation, and
control for the urea-SCR system. He has one PhD student currently
working on developing OBD for urea-SCR systems.


\section{Research Objectives}
\subsection{Approach to the research problem}
Our approach is based on the presumption that the aging detection problem can be framed as a state/parameter estimation challenge with respect to the concentration dynamics of the gases involved. This gives rise to the following sub-problems:

\begin{enumerate}
\item Determining a suitable model for the system dynamics.
\item Assessing whether the available data contains sufficient information for identifying the model parameters related to the chosen system dynamics.
\item Investigating the relationship between the parameters/states and the aging factor of the catalyst.
\item Understanding the uncertainties inherent in the aforementioned processes.
\item Finally, developing and validating the aging detection algorithm.
\end{enumerate}

\subsection{Objectives for 2023 (previously)}
\begin{enumerate}
 \item In the current data, the operating conditions in the truck cover a wider range than the ones in test-cell. So, we wish to validate the SCR-ASC model on test-cell data with operating conditions similar to the truck data. If it is difficult to obtain such experimental data in test-cell, then use a high-fidelity SCR-ASC model in AVL Boost, to validate our low fidelity diagnostics-oriented model across a wide range of transient and steady operating conditions.
 \item Explore other low fidelity diagnostics-oriented SCR-ASC model structures, that could be calibrated using the signals between SCR and ASC that could be obtained from the high-fidelity Boost model.
 \item Validate the model-based and data-driven OBD results using truck data from trucks with DG and/or an EUL catalyst.
 \item Validate the model-based and data-driven OBD results using high-fidelity simulations.
 \item Based on the model and OBD validation results, iterate and improve both model-based and data-driven approaches to achieve robust diagnostics performance validated using high-fidelity simulations and actual data. Also implement a more rigorous and detailed version of the stochastic model-based OBD.
 \item Support TTU in development and demonstration of model-based, data-driven, and frequency-domain OBD methods that rely on detecting NOx-rich regions where ASC is inactive.
\end{enumerate}


\subsection{Objectives for 2024}
\begin{enumerate}
\item Identify the model parameters and parametric uncertainties using
the test-cell data and data from AVL boost model and validate them.
\item Develop the estimation methodology for the storage capacity (Observer Design).
\item Relate catalyst's aging to the storage capacity and develop robust
non-intrusive aging detection algorithm and test the algorithm on the test-cell
data and the road data segments.
\end{enumerate}
\subsection{Objectives post-2024}
\begin{enumerate}
    \item Provide an assessment of the potential to embed the algorithms in a real-time system.
    \item Implementation and comprehensive evaluation, including robustness analysis, of the proposed diagnostic algorithms in engine test cell and on the road.
\end{enumerate}



\section{Summary of work and results from 2023}
\input{secs/4_3state_model.tex}
\input{secs/6_control_form.tex}
\input{secs/5_adsorption_model.tex}
\input{secs/7_cross_sensitivity_est.tex}
\subsection{Conclusions}
The full non-linear model for gas concentrations was derived based on a CSTR
model with reduced-order dynamics, that were previously justified. Model
parameters were determined as explicit functions of reaction rates and the
catalyst's ammonia storage capacity.  Parameter identification, beginning with
the output equation and focusing on $NO_x$ sensor cross-sensitivity ($\chi$),
was carried out using RMC test-cell data from degreened and aged catalysts. A
preliminary indicator of aging was observed from the catalyst's storage capacity
versus temperature curve.


\section{Timeline for 2024}

\begin{table}[H]
    \centering
    \begin{tabular}{l l l}
        \hline\hline
                & Task & $|$Quarter1$|$Quarter2$|$Quarter3$|$Quarter4$|$ \\\hline\hline
        1.      & Model parameter identification   & $|++++|----|----|----|$\\
        2.      & Validating identified model      & $|--++|++--|----|----|$\\
        3.      & Formal definition of aging factor& $|----|--++|----|----|$\\
        4.      & Algorithm development            & $|----|----|++++|++--|$\\
        5.      & Validation                       & $|----|----|----|++++|$\\
        \hline\hline
    \end{tabular}
\end{table}
\section{Deliverables}
The deliverables for the research project will be in the form of documentation
and the code for processing data and validation of algorithms.

\begin{enumerate}
    \item The documentation includes:
\begin{enumerate}
    \item Detailed system model derived from the first principles with assumptions.
    \item Model parameter estimation methods and the results of such endeavor.
    \item Formal definition of aging factor estimation problem.
    \item Aging factor estimation algorithm and validation results.
\end{enumerate}

\item The code repo will include of routines for:
\begin{enumerate}
    \item Model parameter estimation and validation using test-cell data.
\item Programs for handling the AVL boost simulation model provided for model
parameter identification purposes.
\item Aging factor estimation for test-cell and truck data and validation using
test-cell data.
\end{enumerate}

\end{enumerate}


\section{Other requirements}
\begin{itemize}
    \item Prior to the end of this project, a proposal for follow-on work will be submitted to Cummins.
    \item Cummins to provide expertise via mentorship and regular feedback.
    \item Cummins to provide funds to support the students.
    \item Cummins to provide test-cell data with operating conditions similar to on-road trucks
    \item Cummins to provide truck data with at least one and preferably two known aging levels (could be DG and/or EUL)
    \item Cummins to provide access to high-fidelity AVL Boost model for SCR-ASC. This could be a black-box model with access to pre-SCR, post-SCR, post-ASC signals, and NH3 storage values in SCR and ASC.
\end{itemize}

\section{Budget Information}
\newpage
\nocite{}
\bibliographystyle{unsrt}
\bibliography{refs}

\end{document}
